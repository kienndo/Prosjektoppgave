import pandas as pd
from openpyxl import load_workbook
from openpyxl.styles import PatternFill

# Path to your Excel file
file_path = "fishial_species.xlsx"

# Load the Excel file
df = pd.read_excel(file_path)

# List of African species
african_species = [
    "Acroteriobatus annulatus",
    "Aetobatus narinari",
    "Alectis ciliaris",
    "Aluterus scriptus",
    "Amphistichus argenteus",  # (E. Pacific) — remove if you strictly want Africa-only; included earlier by mistake
    "Anguilla anguilla",
    "Ariopsis felis",  # (W. Atlantic) — remove if strictly Africa-only
    "Arothron hispidus",
    "Arothron stellatus",
    "Balistapus undulatus",
    "Balistes capriscus",
    "Balistes vetula",  # E Atlantic presence incl. some African islands/coasts
    "Balistoides viridescens",
    "Belone belone",
    "Boops boops",
    "Caranx crysos",
    "Caranx hippos",
    "Caranx ignobilis",
    "Caranx latus",
    "Caranx lugubris",
    "Caranx melampygus",
    "Caranx sexfasciatus",
    "Carcharhinus leucas",
    "Carcharhinus limbatus",
    "Carcharhinus melanopterus",
    "Carcharhinus obscurus",
    "Carcharhinus plumbeus",
    "Carcharias taurus",
    "Carcharodon carcharias",
    "Cephalopholis argus",
    "Cephalopholis miniata",
    "Chaetodipterus faber",  # marginal E Atlantic records; remove if strict
    "Chloroscombrus chrysurus",
    "Chrysoblephus laticeps",
    "Clarias gariepinus",
    "Conger conger",
    "Coptodon rendalli",
    "Coptodon zillii",
    "Coris julis",
    "Coryphaena hippurus",
    "Ctenolabrus rupestris",
    "Dasyatis pastinaca",
    "Dentex dentex",
    "Dichistius capensis",
    "Diplodus annularis",
    "Diplodus capensis",
    "Diplodus cervinus",
    "Diplodus puntazzo",
    "Diplodus sargus",
    "Diplodus vulgaris",
    "Echeneis naucrates",
    "Elagatis bipinnulata",
    "Epinephelus coioides",
    "Epinephelus fasciatus",
    "Epinephelus lanceolatus",
    "Epinephelus malabaricus",
    "Epinephelus marginatus",
    "Epinephelus merra",
    "Epinephelus tauvina",
    "Epinephelus tukula",
    "Gadus morhua",  # reaches N Africa (Morocco) offshore; remove if strict coastal-only
    "Galeocerdo cuvier",
    "Galeorhinus galeus",
    "Gnathanodon speciosus",
    "Gymnosarda unicolor",
    "Hemigymnus melapterus",
    "Istiophorus albicans",
    "Istiophorus platypterus",
    "Kajikia audax",
    "Katsuwonus pelamis",
    "Kyphosus sectatrix",
    "Kyphosus vaigiensis",
    "Labeobarbus marequensis",
    "Labrus bergylta",
    "Labrus mixtus",
    "Lates calcarifer",  # Indo-West Pacific; remove if Africa-only (not native to Africa)
    "Lichia amia",
    "Lithognathus lithognathus",
    "Lithognathus mormyrus",
    "Lobotes surinamensis",
    "Loligo Vulgaris",
    "Lutjanus argentimaculatus",
    "Lutjanus bohar",
    "Lutjanus decussatus",
    "Lutjanus ehrenbergii",
    "Lutjanus fulviflamma",
    "Lutjanus fulvus",
    "Lutjanus gibbus",
    "Lutjanus johnii",
    "Lutjanus kasmira",
    "Lutjanus monostigma",
    "Lutjanus rivulatus",
    "Lutjanus russellii",
    "Lutjanus sebae",
    "Makaira nigricans",
    "Megalops atlanticus",
    "Megalops cyprinoides",
    "Merlangius merlangus",
    "Mugil cephalus",
    "Mugil curema",
    "Mustelus mustelus",
    "Mycteroperca rubra",
    "Myliobatis aquila",
    "Nebrius ferrugineus",
    "Negaprion brevirostris",
    "Notorynchus cepedianus",
    "Oligoplites saurus",
    "Oreochromis aureus",
    "Oreochromis niloticus",
    "Pachymetopon blochii",
    "Pagrus pagrus",
    "Parupeneus indicus",
    "Pelmatolapia mariae",
    "Platichthys flesus",
    "Platycephalus indicus",
    "Plotosus lineatus",
    "Pomadasys commersonnii",
    "Pomadasys kaakan",
    "Poroderma africanum",
    "Prionace glauca",
    "Rachycentron canadum",
    "Raja clavata",
    "Rhabdosargus sarba",
    "Rhincodon typus",
    "Rutilus rutilus",  # (mainly Europe; introduced in N. Africa) — remove if native-only
    "Sarda sarda",
    "Sarotherodon melanotheron",
    "Sarpa salpa",
    "Scarus ghobban",
    "Scarus psittacus",
    "Scarus niger",
    "Scatophagus argus",  # Western Indian Ocean occurrences
    "Scomber japonicus",
    "Scomber scombrus",
    "Scomberoides commersonnianus",
    "Scomberoides lysan",
    "Scomberomorus commerson",
    "Scomberomorus regalis",
    "Scyliorhinus canicula",
    "Selar crumenophthalmus",
    "Seriola dumerili",
    "Seriola lalandi",
    "Seriola rivoliana",
    "Serranus cabrilla",
    "Serranus scriba",
    "Sparisoma cretense",
    "Sparus aurata",
    "Sphyraena barracuda",
    "Sphyraena jello",
    "Sphyraena obtusata",
    "Sphyraena qenie",
    "Sphyraena viridensis",
    "Sphyrna lewini",
    "Sphyrna mokarran",
    "Sphyrna zygaena",
    "Spondyliosoma cantharus",
    "Squalus acanthias",
    "Symphodus cinereus",
    "Symphodus melops",
    "Symphodus tinca",
    "Synodus saurus",
    "Taeniura lymma",
    "Terapon jarbua",
    "Thalassoma lunare",
    "Thalassoma pavo",
    "Thalassoma purpureum",
    "Thunnus alalunga",
    "Thunnus albacares",
    "Thunnus thynnus",
    "Thyrsites atun",
    "Tilapia sparrmanii",
    "Trachinotus baillonii",
    "Trachinotus blochii",
    "Trachinotus ovatus",
    "Trachurus mediterraneus",
    "Trachurus trachurus",
    "Triaenodon obesus",
    "Trichiurus lepturus",
    "Tylosurus crocodilus",
    "Variola louti",
    "Xiphias gladius",
    "Xyrichtys novacula",
    "Scomberomorus commerson",
    "Scyliorhinus canicula",
    "Selar crumenophthalmus",
    "Seriola dumerili",
    "Seriola lalandi",
    "Seriola rivoliana",
    "Sparisoma cretense",
    "Sparus aurata",
    "Sphyraena barracuda",
    "Sphyraena jello",
    "Sphyraena obtusata",
    "Sphyrna lewini",
    "Sphyrna mokarran",
    "Sphyrna zygaena",
    "Spondyliosoma cantharus",
    "Squalus acanthias",
    "Symphodus melops",
    "Taeniura lymma",
    "Thalassoma purpureum",
    "Thunnus alalunga",
    "Thunnus albacares",
    "Thunnus thynnus",
    "Thyrsites atun",
    "Tilapia sparrmanii",
    "Trachinotus baillonii",
    "Trachinotus blochii",
    "Trachinotus ovatus",
    "Triaenodon obesus",
    "Tylosurus crocodilus",
    "Variola louti",
    "Xiphias gladius",
    "Acroteriobatus annulatus",
    "Aetobatus narinari",
    "Alectis ciliaris",
    "Aluterus scriptus",
    "Balistes capriscus",
    "Belone belone",
    "Caranx crysos",
    "Caranx hippos",
    "Caranx ignobilis",
    "Caranx latus",
    "Caranx lugubris",
    "Caranx melampygus",
    "Caranx sexfasciatus",
    "Carcharhinus leucas",
    "Carcharhinus limbatus",
    "Carcharhinus melanopterus",
    "Carcharhinus obscurus",
    "Carcharhinus plumbeus",
    "Carcharias taurus",
    "Carcharodon carcharias",
    "Coptodon rendalli",
    "Coptodon zillii",
    "Coryphaena hippurus",
    "Dasyatis pastinaca",
    "Dicentrarchus labrax",
    "Echeneis naucrates",
    "Elagatis bipinnulata",
    "Epinephelus coioides",
    "Epinephelus fasciatus",
    "Epinephelus lanceolatus",
    "Epinephelus malabaricus",
    "Epinephelus marginatus",
    "Epinephelus merra",
    "Epinephelus tukula",
    "Gadus morhua",            # reaches NW Africa offshore
    "Galeocerdo cuvier",
    "Galeorhinus galeus",
    "Gnathanodon speciosus",
    "Gymnosarda unicolor",
    "Labrus bergylta",
    "Lichia amia",
    "Lithognathus lithognathus",
    "Lithognathus mormyrus",
    "Lobotes surinamensis",
    "Loligo Vulgaris",
    "Lutjanus argentimaculatus",
    "Lutjanus bohar",
    "Lutjanus decussatus",
    "Lutjanus ehrenbergii",
    "Lutjanus fulviflamma",
    "Lutjanus fulvus",
    "Lutjanus gibbus",
    "Lutjanus johnii",
    "Lutjanus kasmira",
    "Lutjanus rivulatus",
    "Lutjanus russellii",
    "Lutjanus sebae",
    "Makaira nigricans",
    "Megalops atlanticus",
    "Megalops cyprinoides",
    "Merlangius merlangus",
    "Mugil cephalus",
    "Mugil curema",
    "Mustelus mustelus",
    "Mycteroperca rubra",
    "Myliobatis aquila",
    "Nebrius ferrugineus",
    "Negaprion brevirostris",
    "Ocyurus chrysurus",      # E Atlantic islands/Africa margin
    "Oligoplites saurus",     # E Atlantic records incl. W Africa
    "Oreochromis aureus",
    "Oreochromis niloticus",
    "Pachymetopon blochii",
    "Pagrus pagrus",
    "Parupeneus indicus",
    "Pelmatolapia mariae",
    "Platichthys flesus",
    "Platycephalus indicus",  # WIO occurrences
    "Plotosus lineatus",
    "Pomadasys commersonnii",
    "Pomadasys kaakan",
    "Poroderma africanum",
    "Prionace glauca",
    "Rachycentron canadum",
    "Raja clavata",
    "Rhabdosargus sarba",
    "Rhincodon typus",
    "Sarda sarda",
    "Sarotherodon melanotheron",
    "Sarpa salpa",
    "Scarus ghobban",
    "Scarus niger",
    "Scomber japonicus",
    "Scomber scombrus",
    "Scomberoides commersonnianus",
    "Scomberoides lysan",
    "Scomberomorus cavalla",  # E Atlantic (W Africa)
    "Serranus cabrilla",
    "Serranus scriba",
    "Sphyraena viridensis",   # Macaronesia/NW Africa
    "Symphodus cinereus",
    "Symphodus tinca",
    "Synodus saurus",
    "Thalassoma pavo",
    "Trachurus mediterraneus",
    "Trachurus trachurus",
    "Xyrichtys novacula",
]

print(f"Number of African species identified: {len(african_species)}")
num_african_species = 0


# Load workbook and select sheet
wb = load_workbook(file_path)
ws = wb.active

# Color fill for African species
fill_green = PatternFill(start_color="90EE90", end_color="90EE90", fill_type="solid")

# Iterate through rows (assuming species names are in column A)
for row in range(2, ws.max_row + 1):  # Start from row 2 if row 1 is header
    species_name = ws[f"A{row}"].value
    if species_name in african_species:
        ws[f"A{row}"].fill = fill_green  # Mark cell with green
        num_african_species += 1

# Save the modified file
print(f"Total African species marked in the file: {num_african_species}")
wb.save("species_list_marked.xlsx")
